set -e

# clone github
cd /home/eric/
rm -rf cp-vton
git clone https://github.com/ericguillaume/cp-vton.git
cd cp-vton
git checkout master

# extract data
rm -rf /home/eric/dev/data/cp-vton-data
mkdir -p /home/eric/dev/data
cd /home/eric/dev/data
tar -xzf /tmp/cp-vton-data.tar.gz

# link data
cd /home/eric/cp-vton
ln -s /home/eric/dev/data/cp-vton-data/data/train ./data/train
ln -s /home/eric/dev/data/cp-vton-data/data/test ./data/test

# install conda
rm -rf $HOME/miniconda
sudo ln -s /usr/bin/md5sum /usr/bin/md5
wget https://repo.anaconda.com/miniconda/Miniconda3-latest-Linux-x86_64.sh -O ~/miniconda.sh
bash ~/miniconda.sh -b -p $HOME/miniconda

# install requirements
cd /home/eric/cp-vton
conda env create -f environment.yml -n cp-vton
